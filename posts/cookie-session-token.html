<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">Light Up The World</title><link rel="preload" href="/_next/static/css/475c556a47ef2d86.css" as="style"/><link rel="stylesheet" href="/_next/static/css/475c556a47ef2d86.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-7c47d0879e3fabaa.js" defer=""></script><script src="/_next/static/chunks/main-eabf4e641ff2595a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1c3b0aeaafcae3ac.js" defer=""></script><script src="/_next/static/chunks/493-7bce3a15b2a5d2a7.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-ca6a519e8da46302.js" defer=""></script><script src="/_next/static/mNnOww7QOHzeJ-xwEMTkl/_buildManifest.js" defer=""></script><script src="/_next/static/mNnOww7QOHzeJ-xwEMTkl/_ssgManifest.js" defer=""></script></head><body class="antialiased"><div id="__next"><div class="min-h-screen flex flex-col"><nav class="bg-white text-gray-700 py-4 shadow-md"><div class="flex justify-between items-center max-w-7xl mx-auto px-4"><a class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-cyan-400 bg-clip-text text-transparent transition-all duration-300 hover:scale-105 filter drop-shadow-lg" href="/">御风而行</a><div class="flex gap-6"><a class="text-gray-700 font-medium transition-all duration-200 px-2 py-1 rounded hover:bg-gray-100 hover:text-blue-600" href="/">首页</a><a class="text-gray-700 font-medium transition-all duration-200 px-2 py-1 rounded hover:bg-gray-100 hover:text-blue-600" href="/about">关于</a></div></div></nav><main class="flex-1 py-8 max-w-5xl mx-auto w-full"><article class="bg-white rounded-lg p-8 shadow-sm"><h1 class="text-3xl font-bold text-gray-700 mb-2 text-center">Cookie、Session和Token</h1><time class="block text-sm text-gray-600 mb-8 text-center">2017-09-04</time><div class="prose max-w-none text-gray-700 markdown"><p>首先HTTP本身是一个无状态协议，为了进行会话保持和管理，就需要借助一些特定的数据方案。</p>
<h2>Cookie</h2>
<blockquote>
<ol>
<li>HTTP Cookie（也叫 Web Cookie或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。</li>
<li>Cookie 保存在客户端（浏览器）。</li>
<li>Cookie 可设置为长时间保持。</li>
<li>单个 Cookie 保存的数据长度有限制。</li>
<li>Cookie只是实现session的其中一种方案。虽然是最常用的，但并不是唯一的方法。禁用cookie后还有其他方法存储，比如放在url中。</li>
<li>如果只用Cookie不用Session，那么账户信息全部保存在客户端，一旦被劫持，全部信息都会泄露。并且客户端数据量变大，网络传输的数据量也会变大。</li>
</ol>
</blockquote>
<h2>Session</h2>
<blockquote>
<ol>
<li>Session 代表着服务器和客户端一次会话的过程。Session 对象存储特定用户会话所需的属性及配置信息。</li>
<li>Session 保存在服务器端。</li>
<li>Session 中可以保持一些常用变量信息，比如说 UserId 等。</li>
<li>Session 一般失效时间较短。</li>
<li>Session 可存储数据量远高于 Cookie。</li>
<li>用Session只需要在客户端保存一个id，实际上大量数据都是保存在服务端。</li>
<li>Session存储于服务器，可以理解为一个状态列表，拥有一个唯一识别符号SessionId，通常存放于Cookie中。服务器收到Cookie后解析出SessionId，再去Session列表中查找，才能找到相应Session。</li>
<li>为每个用户分配一个唯一的标识符，即SessionID。它的存放形式无非两种，一是经过url传递，二是保存在客户端的cookie里。当然，session也可以保存在数据库中，安全性高，不过效率会变低。</li>
</ol>
</blockquote>
<h2>Token</h2>
<blockquote>
<ol>
<li>Token 机制多用于 App 客户端和服务器交互的模式，也可以用于 Web 端做用户状态管理。</li>
<li>Token 的认证方式类似于临时的证书签名, 并且是一种服务端无状态的认证方式, 非常适合于 REST API 的场景. 所谓无状态就是服务端并不会保存身份认证相关的数据。</li>
<li>Token在客户端一般存放于localStorage，cookie，或sessionStorage中。在服务器一般存于数据库中。</li>
<li>Token可以抵抗CSRF，Cookie+Session不行。</li>
<li>Cookie会被浏览器自动添加到请求头中。但Token不同，Token是开发者为了防范CSRF而特别设计的令牌，浏览器不会自动添加到headers里，攻击者也无法访问用户的Token，所以提交的表单无法通过服务器过滤，也就无法形成攻击。</li>
<li>Token类似一个令牌，无状态，用户信息都被加密到Token中，服务器收到Token后解密就可知道是哪个用户。需要开发者手动添加。</li>
<li>最简单的Token组成
<code>uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign(签名，由Token的前几位+盐以哈希算法压缩成一定长的十六进制字符串，可以防止恶意第三方拼接Token请求服务器)。还可以把不变的参数也放进Token，避免多次查库。</code></li>
</ol>
</blockquote>
</div><div class="flex flex-wrap gap-2 mt-8"><span class="bg-gray-100 text-gray-700 text-sm px-2 py-1 rounded-full">HTTP</span></div></article><div class="mt-12 border-t border-gray-200 pt-8 flex justify-between"><div class="text-gray-600 text-sm flex flex-col items-start"><span class="text-sm text-gray-500">上一篇</span><a class="text-black hover:bg-gray-200 text-base mt-1 font-bold" href="/posts/tech-leader-team-management">简谈技术Leader和团队管理</a></div><div class="ml-auto text-gray-600 text-sm flex flex-col items-end"><span class="text-sm text-gray-500">下一篇</span><a class="text-black hover:bg-gray-200 text-base mt-1 font-bold" href="/posts/https-protocol">HTTPS协议</a></div></div></main><footer class="text-center bg-gray-50 text-gray-700 py-4 shadow-md mt-8"><p>Copyright © <!-- -->2025<!-- --> <!-- -->御风而行<!-- -->. All rights reserved.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"summary":null,"tags":["HTTP"],"id":"cookie-session-token","contentHtml":"\u003cp\u003e首先HTTP本身是一个无状态协议，为了进行会话保持和管理，就需要借助一些特定的数据方案。\u003c/p\u003e\n\u003ch2\u003eCookie\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003eHTTP Cookie（也叫 Web Cookie或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。\u003c/li\u003e\n\u003cli\u003eCookie 保存在客户端（浏览器）。\u003c/li\u003e\n\u003cli\u003eCookie 可设置为长时间保持。\u003c/li\u003e\n\u003cli\u003e单个 Cookie 保存的数据长度有限制。\u003c/li\u003e\n\u003cli\u003eCookie只是实现session的其中一种方案。虽然是最常用的，但并不是唯一的方法。禁用cookie后还有其他方法存储，比如放在url中。\u003c/li\u003e\n\u003cli\u003e如果只用Cookie不用Session，那么账户信息全部保存在客户端，一旦被劫持，全部信息都会泄露。并且客户端数据量变大，网络传输的数据量也会变大。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eSession\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003eSession 代表着服务器和客户端一次会话的过程。Session 对象存储特定用户会话所需的属性及配置信息。\u003c/li\u003e\n\u003cli\u003eSession 保存在服务器端。\u003c/li\u003e\n\u003cli\u003eSession 中可以保持一些常用变量信息，比如说 UserId 等。\u003c/li\u003e\n\u003cli\u003eSession 一般失效时间较短。\u003c/li\u003e\n\u003cli\u003eSession 可存储数据量远高于 Cookie。\u003c/li\u003e\n\u003cli\u003e用Session只需要在客户端保存一个id，实际上大量数据都是保存在服务端。\u003c/li\u003e\n\u003cli\u003eSession存储于服务器，可以理解为一个状态列表，拥有一个唯一识别符号SessionId，通常存放于Cookie中。服务器收到Cookie后解析出SessionId，再去Session列表中查找，才能找到相应Session。\u003c/li\u003e\n\u003cli\u003e为每个用户分配一个唯一的标识符，即SessionID。它的存放形式无非两种，一是经过url传递，二是保存在客户端的cookie里。当然，session也可以保存在数据库中，安全性高，不过效率会变低。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eToken\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003eToken 机制多用于 App 客户端和服务器交互的模式，也可以用于 Web 端做用户状态管理。\u003c/li\u003e\n\u003cli\u003eToken 的认证方式类似于临时的证书签名, 并且是一种服务端无状态的认证方式, 非常适合于 REST API 的场景. 所谓无状态就是服务端并不会保存身份认证相关的数据。\u003c/li\u003e\n\u003cli\u003eToken在客户端一般存放于localStorage，cookie，或sessionStorage中。在服务器一般存于数据库中。\u003c/li\u003e\n\u003cli\u003eToken可以抵抗CSRF，Cookie+Session不行。\u003c/li\u003e\n\u003cli\u003eCookie会被浏览器自动添加到请求头中。但Token不同，Token是开发者为了防范CSRF而特别设计的令牌，浏览器不会自动添加到headers里，攻击者也无法访问用户的Token，所以提交的表单无法通过服务器过滤，也就无法形成攻击。\u003c/li\u003e\n\u003cli\u003eToken类似一个令牌，无状态，用户信息都被加密到Token中，服务器收到Token后解密就可知道是哪个用户。需要开发者手动添加。\u003c/li\u003e\n\u003cli\u003e最简单的Token组成\n\u003ccode\u003euid(用户唯一的身份标识)、time(当前时间的时间戳)、sign(签名，由Token的前几位+盐以哈希算法压缩成一定长的十六进制字符串，可以防止恶意第三方拼接Token请求服务器)。还可以把不变的参数也放进Token，避免多次查库。\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n","date":"2017-09-04","title":"Cookie、Session和Token"},"prevPost":{"summary":null,"tags":["工作"],"id":"tech-leader-team-management","title":"简谈技术Leader和团队管理","date":"2017-09-27"},"nextPost":{"summary":null,"tags":["HTTP"],"id":"https-protocol","title":"HTTPS协议","date":"2017-08-31"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"cookie-session-token"},"buildId":"mNnOww7QOHzeJ-xwEMTkl","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>