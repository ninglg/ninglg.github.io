<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">Light Up The World</title><link rel="preload" href="/_next/static/css/f746a819331ac28f.css" as="style"/><link rel="preload" href="/_next/static/css/67a8467bbb0bf2f3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f746a819331ac28f.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/67a8467bbb0bf2f3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-6f8766cf045e0663.js" defer=""></script><script src="/_next/static/chunks/pages/_app-395f9b40f90241c5.js" defer=""></script><script src="/_next/static/chunks/8-20d97a1f65308574.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-f6a8d15cf5758418.js" defer=""></script><script src="/_next/static/19D7Ntg06Lp4t0-2KoMZC/_buildManifest.js" defer=""></script><script src="/_next/static/19D7Ntg06Lp4t0-2KoMZC/_ssgManifest.js" defer=""></script></head><body class="antialiased"><div id="__next"><div class="Post_container__ictJu"><nav class="Nav_nav__o8sSc"><div class="Nav_navContainer__KuO9f"><a class="Nav_navLogo__aczrM" href="/">Light Ning</a><div class="Nav_navLinks__sb_3K"><a class="Nav_navLink__z2PDT " href="/">首页</a><a class="Nav_navLink__z2PDT " href="/about">关于</a></div></div></nav><main class="Post_main__X4Tic"><article class="Post_post__1KH4p"><h1 class="Post_title__pen_7">awk命令的一些常见用法</h1><time class="Post_date__YGL_Q">2010-08-06</time><div class="Post_postTags__df1Jm"><span class="Post_postTag__j37er">Linux</span></div><div class="Post_content__aWM2C"><p>此篇介绍一下awk命令的一些常见用法。</p>
<p>awk命令的使用模式</p>
<blockquote>
<p>awk 'BEGIN{}pattern{commands}END{}' file_name</p>
</blockquote>
<h2>取出第2列的内容</h2>
<blockquote>
<p>awk -F',' '{print $2}' data.txt</p>
</blockquote>
<h2>输出每一行有多少列</h2>
<blockquote>
<p>awk '{print NF}' data.txt</p>
</blockquote>
<h2>输出每一行最后一列的值</h2>
<blockquote>
<p>awk '{print $NF}' data.txt</p>
</blockquote>
<h2>如果第一列小于第二列则打印此行</h2>
<blockquote>
<p>awk '{if ($1 &#x3C; $2) print $0}' data.txt</p>
</blockquote>
<h2>如果第一列大于100则打印第一列，否则打印ok</h2>
<blockquote>
<p>awk '{if ($1 > 100) print $1; else print "ok"}' data.txt</p>
</blockquote>
<h2>打印除最后列之外的所有列</h2>
<blockquote>
<p>awk -F':' {'$NF="";print $0'} data.txt</p>
</blockquote>
<h2>打印s在每一行第一个域中的位置，若为0表示没有这个字符</h2>
<blockquote>
<p>awk -F '#' '{print (index($1, "s"))}' data.txt</p>
</blockquote>
<h2>对某列的数字求和</h2>
<blockquote>
<p>awk '{sum += $1}END{print sum}' data.txt</p>
</blockquote>
<h2>在保持文件原有内容顺序的基础上删除重复的行</h2>
<blockquote>
<p>awk '!visited[$0]++' data.txt > result.txt</p>
</blockquote>
<pre><code>1. visited[]相当于维护了一个关联数据，键为一行的内容，值为该行出现的次数
2. 省略的默认动作是打印该行
3. 如用sort会改变文件内容顺序，uniq仅能去重排序连续的行
</code></pre>
<h2>NR，FNR，NF</h2>
<pre><code>1. NR表示从awk开始执行后，按照记录分隔符读取的数据次数。默认的记录分隔符为换行符，因此默认的就是读取的数据行数，NR可以理解为Number of Record的缩写。

2. 在awk处理多个输入文件的时候，在处理完第一个文件后，NR并不会从1开始，而是继续累加，因此就出现了FNR，每当处理一个新文件的时候，FNR就从1开始计数，FNR可以理解为File Number of Record。

3. NR==FNR：用于在读取两个或两个以上的文件时，判断是不是在读取第一个文件。

4. NF表示目前的记录被分割的字段的数目，NF可以理解为Number of Field。
</code></pre>
<h2>处理多个文件</h2>
<p>awk处理多个文件的基本语法是:</p>
<blockquote>
<p>awk -F分隔符 'BEGIN { 初始化 } { 循环执行部分 } END { 结束处理 }' file_list1 file_list2</p>
</blockquote>
<p>其中BEGIN和END可以省略，-F也可以使用默认，循环执行部分，是按行对文件进行处理的。</p>
</div></article><div class="Post_postNavigation__TSrfz"><a class="Post_navLink__iyGDb" href="/posts/common-algorithm-thoughts">← <!-- -->常用算法思想</a><a class="Post_navLink__iyGDb Post_nextLink__THXHn" href="/posts/what-is-binary-safe">二进制安全的概念<!-- --> →</a></div></main><footer class="footer_footer__mqdak"><p>Copyright © <!-- -->2025<!-- --> <!-- -->Light Ning<!-- -->. All rights reserved.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"summary":null,"tags":["Linux"],"id":"awk-command-usage","contentHtml":"\u003cp\u003e此篇介绍一下awk命令的一些常见用法。\u003c/p\u003e\n\u003cp\u003eawk命令的使用模式\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk 'BEGIN{}pattern{commands}END{}' file_name\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e取出第2列的内容\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk -F',' '{print $2}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e输出每一行有多少列\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '{print NF}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e输出每一行最后一列的值\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '{print $NF}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e如果第一列小于第二列则打印此行\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '{if ($1 \u0026#x3C; $2) print $0}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e如果第一列大于100则打印第一列，否则打印ok\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '{if ($1 \u003e 100) print $1; else print \"ok\"}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e打印除最后列之外的所有列\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk -F':' {'$NF=\"\";print $0'} data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e打印s在每一行第一个域中的位置，若为0表示没有这个字符\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk -F '#' '{print (index($1, \"s\"))}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e对某列的数字求和\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '{sum += $1}END{print sum}' data.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003e在保持文件原有内容顺序的基础上删除重复的行\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk '!visited[$0]++' data.txt \u003e result.txt\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode\u003e1. visited[]相当于维护了一个关联数据，键为一行的内容，值为该行出现的次数\n2. 省略的默认动作是打印该行\n3. 如用sort会改变文件内容顺序，uniq仅能去重排序连续的行\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eNR，FNR，NF\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e1. NR表示从awk开始执行后，按照记录分隔符读取的数据次数。默认的记录分隔符为换行符，因此默认的就是读取的数据行数，NR可以理解为Number of Record的缩写。\n\n2. 在awk处理多个输入文件的时候，在处理完第一个文件后，NR并不会从1开始，而是继续累加，因此就出现了FNR，每当处理一个新文件的时候，FNR就从1开始计数，FNR可以理解为File Number of Record。\n\n3. NR==FNR：用于在读取两个或两个以上的文件时，判断是不是在读取第一个文件。\n\n4. NF表示目前的记录被分割的字段的数目，NF可以理解为Number of Field。\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e处理多个文件\u003c/h2\u003e\n\u003cp\u003eawk处理多个文件的基本语法是:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk -F分隔符 'BEGIN { 初始化 } { 循环执行部分 } END { 结束处理 }' file_list1 file_list2\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e其中BEGIN和END可以省略，-F也可以使用默认，循环执行部分，是按行对文件进行处理的。\u003c/p\u003e\n","date":"2010-08-06T10:00:00.000Z","title":"awk命令的一些常见用法","published":true,"hideInList":false,"feature":null},"prevPost":{"summary":null,"tags":["算法"],"id":"common-algorithm-thoughts","title":"常用算法思想","date":"2010-10-01T10:00:00.000Z","published":true,"hideInList":false,"feature":null,"isTop":false},"nextPost":{"summary":null,"tags":["Redis"],"id":"what-is-binary-safe","title":"二进制安全的概念","date":"2010-08-04T10:00:00.000Z","published":true,"hideInList":false,"feature":null}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"awk-command-usage"},"buildId":"19D7Ntg06Lp4t0-2KoMZC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>