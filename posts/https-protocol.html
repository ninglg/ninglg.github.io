<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">Light Up The World</title><link rel="preload" href="/_next/static/css/38bd5d5cff1a97ec.css" as="style"/><link rel="preload" href="/_next/static/css/67a8467bbb0bf2f3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/38bd5d5cff1a97ec.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/67a8467bbb0bf2f3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0d0518cf5dc92fa8.js" defer=""></script><script src="/_next/static/chunks/framework-6c7418e6436abbda.js" defer=""></script><script src="/_next/static/chunks/main-337427424dcda4f8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-abba8f27a92acb47.js" defer=""></script><script src="/_next/static/chunks/8-31eaf657f5c19175.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-621cfbb84ba78acf.js" defer=""></script><script src="/_next/static/DQUV_1P5d5M_T4EvFA1s5/_buildManifest.js" defer=""></script><script src="/_next/static/DQUV_1P5d5M_T4EvFA1s5/_ssgManifest.js" defer=""></script></head><body class="antialiased"><div id="__next"><div class="Post_container__ictJu"><nav class="Nav_nav__o8sSc"><div class="Nav_navContainer__KuO9f"><a class="Nav_navLogo__aczrM" href="/">Light Ning</a><div class="Nav_navLinks__sb_3K"><a class="Nav_navLink__z2PDT " href="/">首页</a><a class="Nav_navLink__z2PDT " href="/about">关于</a></div></div></nav><main class="Post_main__X4Tic"><article class="Post_post__1KH4p"><h1 class="Post_title__pen_7">HTTPS协议</h1><time class="Post_date__YGL_Q">2017-08-31</time><div class="Post_postTags__df1Jm"><span class="Post_postTag__j37er">HTTP</span></div><div class="prose max-w-none"><p>此篇记录一些HTTPS协议相关的内容。</p>
<h2>HTTPS 基础</h2>
<ol>
<li>为了解决HTTP的安全性问题，HTTPS做了加密通信。在传输层增加了一层 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 来加密 HTTP 的通信内容。</li>
<li>SSL指的是安全套接字层——一种通过加密和身份验证在网络浏览器和服务器之间传输数据时添加密钥的小型数据文件。</li>
<li>HTTPS 采用混合的加密机制，使用公开密钥加密用于传输对称密钥，之后使用对称密钥加密进行通信。</li>
<li>HTTPS 通过使用 证书（数字证书认证机构CA，Certificate Authority） 来对通信方进行认证。</li>
<li>进行 HTTPS 通信时，服务器会把证书发送给客户端，客户端取得其中的公开密钥之后，先进行验证，如果验证通过，就可以开始通信。</li>
<li>TLS 握手协议</li>
</ol>
<blockquote>
<p>握手协议是整个 TLS 协议簇中最最核心的协议，HTTPS 能保证安全也是因为它的功劳。
握手协议由多个子消息构成，服务端和客户端第一次完成一次握手需要 2-RTT。
握手协议的目的是为了双方协商出密码块，这个密码块会交给 TLS 记录层进行密钥加密。也就是说握手协议达成的“共识”(密码块)是整个 TLS 和 HTTPS 安全的基础。</p>
</blockquote>
<h2>HTTPS 配置项</h2>
<ol>
<li>Nginx使用配置项 ssl_certificate 进行证书配置。</li>
<li>HTTPS提供了端到端的安全加密。不仅提供数据机密性（加密），还提供数据完整性（不被篡改数据）保护、防重放（把捕获的报文再发一次无效）。</li>
<li>加密传输之后，有了HMAC保护，任何篡改页面的尝试，由于没有session key，无法计算出和篡改网页一致的HMAC，所以数据接收端的SSL/TLS会轻易地识别出网页已被篡改，然后丢弃。既然无法劫持，也就没有篡改的冲动了，所以HTTPS可以很好地对付网页劫持。</li>
</ol>
<h2>非对称加密</h2>
<p>“非对称加密”的加密算法，特点是私钥加密后的密文，只要是公钥都可以解密。但是公钥加密后的密文，只有私钥可以解密。
私钥只有一个人有，而公钥可以发给所有的人。</p>
<h2>加密算法协商</h2>
<p><strong>如何做到Web服务器针对每个客户端使用不同的对称加密算法？</strong>
使用随机数来生成对称加密算法。这样就可以做到服务器和客户端每次交互都是新的加密算法、只有在交互的那一该才确定加密算法。这也是为什么HTTPS协议握手阶段会有这么多的随机数的原因。</p>
<h2>公钥分发</h2>
<p>服务器端将公钥发送给每一个客户端。</p>
<h2>数字签名</h2>
<p>解决同一机构颁发的不同证书被篡改问题。</p>
<h2>客户端验证</h2>
<p>客户端本地怎么验证证书呢？答案是证书本身就已经告诉客户端怎么验证证书的真伪。证书上写着如何根据证书的内容生成证书编号。客户端拿到证书后根据证书上的方法自己生成一个证书编号，如果生成的证书编号与证书上的证书编号相同，那么说明这个证书是真实的。同时，为避免证书编号本身又被调包，所以使用第三方的私钥进行加密。</p>
<h2>证书颁发机构</h2>
<p>现实中，浏览器和操作系统都会维护一个权威的第三方机构列表（包括它们的公钥）。因为客户端接收到的证书中会写有颁发机构，客户端就根据这个颁发机构的值在本地找相应的公钥。</p>
<blockquote>
<p>HTTP 的端口号是 80，HTTPS 的端口号是 443。</p>
</blockquote>
</div></article><div class="Post_postNavigation__TSrfz"><a class="Post_navLink__iyGDb" href="/posts/cookie-session-token">← <!-- -->Cookie、Session和Token</a><a class="Post_navLink__iyGDb Post_nextLink__THXHn" href="/posts/how-to-recruit-the-right-person">如何招聘到对的人<!-- --> →</a></div></main><footer class="footer_footer__mqdak"><p>© <!-- -->2025<!-- --> <!-- -->Light Ning<!-- --> All rights reserved.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"summary":null,"tags":["HTTP"],"id":"https-protocol","contentHtml":"\u003cp\u003e此篇记录一些HTTPS协议相关的内容。\u003c/p\u003e\n\u003ch2\u003eHTTPS 基础\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e为了解决HTTP的安全性问题，HTTPS做了加密通信。在传输层增加了一层 SSL（Secure Sockets Layer 安全套接层）/ TLS (Transport Layer Security 安全层传输协议) 来加密 HTTP 的通信内容。\u003c/li\u003e\n\u003cli\u003eSSL指的是安全套接字层——一种通过加密和身份验证在网络浏览器和服务器之间传输数据时添加密钥的小型数据文件。\u003c/li\u003e\n\u003cli\u003eHTTPS 采用混合的加密机制，使用公开密钥加密用于传输对称密钥，之后使用对称密钥加密进行通信。\u003c/li\u003e\n\u003cli\u003eHTTPS 通过使用 证书（数字证书认证机构CA，Certificate Authority） 来对通信方进行认证。\u003c/li\u003e\n\u003cli\u003e进行 HTTPS 通信时，服务器会把证书发送给客户端，客户端取得其中的公开密钥之后，先进行验证，如果验证通过，就可以开始通信。\u003c/li\u003e\n\u003cli\u003eTLS 握手协议\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e握手协议是整个 TLS 协议簇中最最核心的协议，HTTPS 能保证安全也是因为它的功劳。\n握手协议由多个子消息构成，服务端和客户端第一次完成一次握手需要 2-RTT。\n握手协议的目的是为了双方协商出密码块，这个密码块会交给 TLS 记录层进行密钥加密。也就是说握手协议达成的“共识”(密码块)是整个 TLS 和 HTTPS 安全的基础。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2\u003eHTTPS 配置项\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eNginx使用配置项 ssl_certificate 进行证书配置。\u003c/li\u003e\n\u003cli\u003eHTTPS提供了端到端的安全加密。不仅提供数据机密性（加密），还提供数据完整性（不被篡改数据）保护、防重放（把捕获的报文再发一次无效）。\u003c/li\u003e\n\u003cli\u003e加密传输之后，有了HMAC保护，任何篡改页面的尝试，由于没有session key，无法计算出和篡改网页一致的HMAC，所以数据接收端的SSL/TLS会轻易地识别出网页已被篡改，然后丢弃。既然无法劫持，也就没有篡改的冲动了，所以HTTPS可以很好地对付网页劫持。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003e非对称加密\u003c/h2\u003e\n\u003cp\u003e“非对称加密”的加密算法，特点是私钥加密后的密文，只要是公钥都可以解密。但是公钥加密后的密文，只有私钥可以解密。\n私钥只有一个人有，而公钥可以发给所有的人。\u003c/p\u003e\n\u003ch2\u003e加密算法协商\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e如何做到Web服务器针对每个客户端使用不同的对称加密算法？\u003c/strong\u003e\n使用随机数来生成对称加密算法。这样就可以做到服务器和客户端每次交互都是新的加密算法、只有在交互的那一该才确定加密算法。这也是为什么HTTPS协议握手阶段会有这么多的随机数的原因。\u003c/p\u003e\n\u003ch2\u003e公钥分发\u003c/h2\u003e\n\u003cp\u003e服务器端将公钥发送给每一个客户端。\u003c/p\u003e\n\u003ch2\u003e数字签名\u003c/h2\u003e\n\u003cp\u003e解决同一机构颁发的不同证书被篡改问题。\u003c/p\u003e\n\u003ch2\u003e客户端验证\u003c/h2\u003e\n\u003cp\u003e客户端本地怎么验证证书呢？答案是证书本身就已经告诉客户端怎么验证证书的真伪。证书上写着如何根据证书的内容生成证书编号。客户端拿到证书后根据证书上的方法自己生成一个证书编号，如果生成的证书编号与证书上的证书编号相同，那么说明这个证书是真实的。同时，为避免证书编号本身又被调包，所以使用第三方的私钥进行加密。\u003c/p\u003e\n\u003ch2\u003e证书颁发机构\u003c/h2\u003e\n\u003cp\u003e现实中，浏览器和操作系统都会维护一个权威的第三方机构列表（包括它们的公钥）。因为客户端接收到的证书中会写有颁发机构，客户端就根据这个颁发机构的值在本地找相应的公钥。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHTTP 的端口号是 80，HTTPS 的端口号是 443。\u003c/p\u003e\n\u003c/blockquote\u003e\n","date":"2017-08-31T16:29:59.000Z","title":"HTTPS协议","published":true,"hideInList":false,"feature":null,"isTop":false},"prevPost":{"summary":null,"tags":["HTTP"],"id":"cookie-session-token","title":"Cookie、Session和Token","date":"2017-09-04T17:14:31.000Z","published":true,"hideInList":false,"feature":null,"isTop":false},"nextPost":{"summary":null,"tags":["工作"],"id":"how-to-recruit-the-right-person","title":"如何招聘到对的人","date":"2017-08-16T00:29:02.000Z","published":true,"hideInList":false,"feature":null,"isTop":false}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"https-protocol"},"buildId":"DQUV_1P5d5M_T4EvFA1s5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>