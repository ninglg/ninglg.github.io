{"pageProps":{"post":{"summary":null,"tags":["Docker"],"id":"docker-commands-middleware-example","contentHtml":"<h1>Docker</h1>\n<h2>查看docker系统信息</h2>\n<blockquote>\n<p>docker info</p>\n</blockquote>\n<h2>查看docker版本信息</h2>\n<blockquote>\n<p>docker version</p>\n</blockquote>\n<h2>查看镜像/容器/数据卷所占的空间</h2>\n<blockquote>\n<p>docker system df</p>\n</blockquote>\n<hr>\n<h1>镜像</h1>\n<h2>搜索镜像</h2>\n<blockquote>\n<p>按名称搜索 docker search redis\n按条件搜索 docker search --filter \"is-official=true\" --filter \"stars=3\"</p>\n</blockquote>\n<h2>下载最新或指定版本的镜像</h2>\n<blockquote>\n<p>docker pull redis\ndocker pull redis:5.0.5\ndocker pull mysql:latest\ndocker pull grafana/grafana</p>\n</blockquote>\n<h2>列出本地镜像</h2>\n<blockquote>\n<p>docker images 或 docker image ls</p>\n</blockquote>\n<h2>批量获取镜像ID</h2>\n<blockquote>\n<p>docker image ls -a -q</p>\n</blockquote>\n<h2>查看镜像详细信息</h2>\n<blockquote>\n<p>docker image inspect [镜像名称]</p>\n</blockquote>\n<h2>删除镜像或容器</h2>\n<blockquote>\n<p>docker image rm [xxxxxx]\ndocker rmi [xxxxxx]\n删除无用的虚悬镜像 docker image prune\n删除一个或多个容器 docker rm []\n删除所有镜像 docker rmi $(docker images -q)\n批量删除镜像 docker  image   rm   $(docker  image  ls   -a  -q)\n批量删除容器 docker   container   rm  $(docker  container  ls   -a  -q)\n删除untagged images，也就是id为None的镜像 docker rmi $(docker images | grep \"^<none>\" | awk \"{print $3}\")</p>\n</blockquote>\n<hr>\n<h1>容器</h1>\n<h2>运行、启动和停止容器</h2>\n<blockquote>\n<p>docker run --name docker-redis  --restart=always -d -p 6379:6379 redis\ndocker run -itd --name docker-mysql --restart=always -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7\ndocker run --name docker-nginx --restart=always -d -p 8080:80 -v /Users/ninglg/nginx:/usr/share/nginx/html nginx\ndocker run -d --name=docker-grafana --restart=always -p 3000:3000 grafana/grafana\ndocker run --name docker-etcd --restart=always -d -p 2379:2379 -p 2380:2380 elcolio/etcd\n启动容器 docker start [容器名/ID]\n停止容器 docker stop [容器名/ID]\n批量停止容器 docker container   stop   $(docker  container  ls   -a  -q)\n强制停止容器 docker kill [容器名/ID]\n后置设置更新容器自启动 docker update --restart=always [容器名/id]</p>\n</blockquote>\n<h3>设置挂载（如redis为例）</h3>\n<blockquote>\n<p>-v /opt/data/redis:/data ##将主机中/opt/data/redis目录下的redis挂载到容器的/data\n-v /opt/data/redis/redis.conf:/etc/redis/redis.conf ##将主机中redis.conf配置文件挂载到容器的/etc/redis/redis.conf文件中</p>\n</blockquote>\n<h3>指定容器数据卷启动 (等于主机目录挂载到容器指定目录)</h3>\n<blockquote>\n<p>docker run -it -v 主机目录:容器目录 镜像名\ndocker run -it -v /mydata:/mydata centos</p>\n</blockquote>\n<h2>查看运行中、历史创建的、所有的容器</h2>\n<blockquote>\n<p>docker ps\ndocker ps -n 5\ndocker ps -a</p>\n</blockquote>\n<h2>访问容器</h2>\n<blockquote>\n<p>docker exec -it docker-redis redis-cli\ndocker exec -it docker-mysql mysql -uroot -p123456\ndocker exec -it docker-nginx bash\ndocker exec -it docker-etcd /bin/sh</p>\n</blockquote>\n<h2>获取容器ID或名字</h2>\n<blockquote>\n<p>docker container ls -a</p>\n</blockquote>\n<h2>批量获取容器ID</h2>\n<blockquote>\n<p>docker container ls -a -q</p>\n</blockquote>\n<h2>查看容器详细信息</h2>\n<blockquote>\n<p>docker inspect [容器名称]</p>\n</blockquote>\n<h2>查看容器所属的ip地址：</h2>\n<blockquote>\n<p>docker inspect docker-redis | grep IPAddress</p>\n</blockquote>\n<hr>\n<h1>docker管理</h1>\n<h2>数据卷管理</h2>\n<blockquote>\n<p>docker volume create 数据卷名称  #创建数据卷\ndocker volume rm 数据卷名称  #删除数据卷\ndocker volume inspect 数据卷名称  #查看数据卷</p>\n</blockquote>\n<h2>网络管理</h2>\n<blockquote>\n<p>docker network ls 查看网络信息\ndocker network create --subnet=网段 网络名称\ndocker network rm 网络名称</p>\n</blockquote>\n<h1>容器编排</h1>\n<blockquote>\n<p>docker-compose</p>\n</blockquote>\n<p>创建一个docker-compose.yml文件</p>\n<hr>\n<h1>构建镜像</h1>\n<h2>创建镜像</h2>\n<blockquote>\n<p>docker build 或 docker build -t docker-xxx:0.1 .</p>\n</blockquote>\n<pre><code class=\"language-txt\">env GOOS=linux GOARCH=386 go build main.go\ndocker build -t main:v1 .\ndocker run --name docker-main -d -p 8090:8090 main:v1\n</code></pre>\n","date":"2018-02-03","title":"Docker常用命令及中间件应用示例"},"prevPost":{"summary":null,"tags":["数据结构"],"id":"r-tree-intro","title":"数据结构：R树","date":"2018-03-29"},"nextPost":{"summary":null,"tags":["Golang"],"id":"useful-golang-commands","title":"一些实用的Go工具命令","date":"2018-02-02"}},"__N_SSG":true}