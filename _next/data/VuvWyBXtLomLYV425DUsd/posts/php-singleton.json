{"pageProps":{"post":{"summary":null,"tags":["PHP"],"id":"php-singleton","contentHtml":"<h2>什么是单例</h2>\n<p>单例模式，主要是保证在面向对象编程设计中，一个类只能有一个实例对象存在（即仅实例化一次）。</p>\n<h2>单例的优点</h2>\n<ol>\n<li>PHP的每次请求访问都是一次独立的进程，比如为了执行多个SQL语句，只实例化一次数据库连接就足够了，可以提高效率</li>\n<li>使用单例模式可以避免大量的new操作，减少对资源的消耗，节省内存</li>\n</ol>\n<h2>单例的应用场景</h2>\n<ol>\n<li>建立目录</li>\n<li>数据库连接及操作</li>\n<li>系统日志</li>\n</ol>\n<h2>单例的实现方法</h2>\n<p>所有的单例模式都至少拥有以下3种公共元素：</p>\n<ol>\n<li>拥有一个构造函数，并且必须被标记为private</li>\n<li>拥有一个保存类的实例的静态成员变量</li>\n<li>拥有一个访问这个实例的公共静态方法，用于创建或获取它本身的静态私有对象</li>\n</ol>\n<h2>单例的例子</h2>\n<p><strong>第一种：</strong></p>\n<pre><code class=\"language-php\">&#x3C;?php\n/**\n * PHP单例类\n */\nclass Singleton {\n    /**\n     * 私有静态变量，保存全局实例\n     */\n    private static  $_instance = null;\n \n    /**\n     * 私有化默认构造方法，保证外界无法直接实例化，只能内部使用new去创建对象\n     */\n    private function __construct() {\n        // 可以在此处实现一些数据库连接等操作\n    }\n \n    /**\n     * 静态工厂方法，返回此类的唯一实例\n     */\n    public static function getInstance() {\n        if (is_null(self::$_instance)) {\n            self::$_instance = new self();  // 实例化本类对象\n        }\n \n        return self::$_instance;\n    }\n \n    /**\n     * 防止用户克隆实例\n     */\n    public function __clone(){\n        die('Clone is not allowed.' . E_USER_ERROR);\n    }\n \n    /**\n     * 测试用方法\n     */\n    public function test() {\n        echo 'Singleton Test!';\n    }\n \n}\n \n/**\n * 客户端\n */\nclass Client {\n    public static function main() {\n        $instance = Singleton::getInstance();\n        $instance->test();\n    }\n}\n \nClient::main();\n</code></pre>\n<p><strong>第二种：</strong></p>\n<pre><code class=\"language-php\">static function getInstance($class, $param = array())\n{\n    if (!isset($obj[$class])) {\n\t$obj[$class] = new $class($param);\n    }\n    \n\treturn $obj[$class];\n}\n</code></pre>\n","date":"2010-07-21T00:00:00.000Z","title":"PHP单例设计模式"},"prevPost":{"summary":null,"tags":["Linux"],"id":"mac-port-used-netstat-lsof","title":"Mac系统上查询端口占用的命令","date":"2010-07-23T00:00:00.000Z"},"nextPost":{"summary":null,"tags":["生活"],"id":"youth-sideline","title":"年轻人的副业","date":"2010-07-19T00:00:00.000Z"}},"__N_SSG":true}