{"pageProps":{"post":{"summary":null,"tags":["PHP"],"id":"php-fpm-status-path","contentHtml":"<p>此篇介绍一下启用php-fpm的status后获取到的运行状态信息。</p>\n<!-- more -->\n<h3>启用php-fpm状态功能</h3>\n<pre><code># cat php-fpm.conf | grep status_path\npm.status_path = /status\n</code></pre>\n<h3>nginx配置</h3>\n<pre><code>server {\n    listen 8080;\n    server_name  localhost;\n\n    location ~ ^/(status|ping)$\n    {\n            include fastcgi_params;\n            fastcgi_pass 127.0.0.1:9000;\n            fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n    }\n}\n</code></pre>\n<h3>重启php-fpm和nginx</h3>\n<h3>打开status页面</h3>\n<pre><code># curl 'http://127.0.0.1:8080/status'\n\npool:                 www               //池子名称，大多为www\nprocess manager:      dynamic           //进程管理方式，有static、dynamic或ondemand\nstart time:  14/Jul/2010:10:09:03 +0800  //启动日期，如果reload了php-fpm时间会更新\nstart since:          3290              //运行时长\naccepted conn:        6                 //当前池子接受的请求数\nlisten queue:         0     //请求等待队列，如果此值不为0，则需要增加fpm的进程数量\nmax listen queue:     0     //请求等待队列最高的数量\nlisten queue len:     0     //socket等待队列长度\nidle processes:       1     //空闲进程数量\nactive processes:     1     //活跃进程数量\ntotal processes:      2     //总进程数量\nmax active processes: 1     //最大的活跃进程数量（fpm启动开始算）\nmax children reached: 0     //达到进程最大数量限制的次数，如果此值不为0则要增加进程数\nslow requests:        0     //启动fpm的slow-log，慢请求的数量\n</code></pre>\n<h3>其他参数</h3>\n<p>php-fpm状态页可以带参数如json、xml、html并且可以和full做组合。</p>\n<pre><code># curl 'http://127.0.0.1:8080/status?json'\n\n# curl 'http://127.0.0.1:8080/status?xml'\n\n# curl 'http://127.0.0.1:8080/status?html'\n\n# curl 'http://127.0.0.1:8080/status?full'\n</code></pre>\n<p>php-fpm的状态页可以用作监控数据观察，展示的话，使用zabbix或者nagios时可以考虑用xml或者默认方式。用web展示的话，可以直接用html格式表格结果。</p>\n","date":"2010-07-14T10:00:00.000Z","title":"启用php-fpm的状态页","published":true,"hideInList":false,"feature":null,"isTop":false},"prevPost":{"summary":null,"tags":["生活"],"id":"youth-sideline","title":"年轻人的副业","date":"2010-07-19T10:00:00.000Z","published":true,"hideInList":false,"feature":null,"isTop":false},"nextPost":{"summary":null,"tags":["Linux"],"id":"linux-profiling-debug-tool-command","title":"Linux常用分析定位工具命令","date":"2010-07-12T10:00:00.000Z","published":true,"hideInList":false,"feature":null,"isTop":false}},"__N_SSG":true}